<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MTB CAT1 Peripheral driver library: I3C          (I3C)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="IFXCYP_one-line.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MTB CAT1 Peripheral driver library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__cy__i3c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle">
<div class="title">I3C (I3C)</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p>Driver API for I3C Bus Peripheral. </p>
<p>I3C - The Improved Inter-Integrated Circuit (I3C) bus is a MIPI industry-standard.</p>
<p>The functions and other declarations used in this part of the driver are in cy_i3c.h. You can also include cy_pdl.h to get access to all functions and declarations in the PDL.</p>
<p>The I3C peripheral driver provides an API to implement I3C in Target, Main-Controller, or Secondary-Controller roles based on the DW I3C hardware block. This I3C bus is capable of supporting I3C as well as I2C target devices as defined in the specification. I2C targets are supported with Fast-mode, and Fast-mode Plus with external 50ns spike filter as per I3C specification.</p>
<p>Features:</p><ul>
<li>An industry-standard I3C bus interface</li>
<li>Supports target, main controller, and secondary controller operation</li>
<li>SCL frequency up to 12.5MHz (SDR data rate 12.5Mbps, HDR-DDR data rate at 25Mbps)</li>
<li>In controller mode, number of addressable target devices is 11</li>
<li>Works in active power mode only</li>
<li>Does not support I3C HDR-TSP/TSR modes</li>
<li>Does not support I3C CDR (clock data recovery)</li>
<li>Does not support I3C address arbitration optimizations</li>
<li>Does not support I3C IBI with data</li>
<li>Does not support I3C time stamping</li>
<li>Does not support vendor specific CCCs</li>
<li>Does not support I2C target role</li>
</ul>
<h1><a class="anchor" id="group_cy_i3c_configuration"></a>
Configuration Considerations</h1>
<p>The I3C driver configuration can be divided to number of sequential steps listed below:</p><ul>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_config">Configure i3c</a></li>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_pins">Assign and Configure Pins</a></li>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_clock">Assign Clock Divider</a></li>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_data_rate">Configure Data Rate</a></li>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_intr">Configure Interrupt</a></li>
<li><a class="el" href="group__group__cy__i3c.html#group_i3c_enable">Enable I3C</a></li>
</ul>
<h2><a class="anchor" id="group_i3c_config"></a>
Configure i3c</h2>
<p>To set up the I3C driver, provide the configuration parameters in the <a class="el" href="structcy__stc__i3c__config__t.html">cy_stc_i3c_config_t</a> structure. Provide i3cMode to the select operation mode target, controller or secondary controller-target. To initialize the driver, call <a class="el" href="group__group__i3c__general__functions.html#ga059861a80e44e10f15f8b31679a4a670">Cy_I3C_Init</a> function providing a pointer to the populated <a class="el" href="structcy__stc__i3c__config__t.html">cy_stc_i3c_config_t</a> structure and the allocated <a class="el" href="structcy__stc__i3c__context__t.html">cy_stc_i3c_context_t</a> structure.</p>
<p>For I3C target setup read and write buffer before enabling its operation using <a class="el" href="group__group__i3c__target__functions.html#ga781eaf02de8da98ff85a2344e45dfdc6">Cy_I3C_TargetConfigReadBuf</a> and <a class="el" href="group__group__i3c__target__functions.html#ga69be0f9ba226fcbdbf7d5aeca0eb8a20">Cy_I3C_TargetConfigWriteBuf</a> appropriately. Note that the controller reads data from the target read buffer and writes data into the target write buffer.</p>
<h2><a class="anchor" id="group_i3c_pins"></a>
Assign and Configure Pins</h2>
<p>Only dedicated pins can be used for I3C operation. The HSIOM register must be configured to connect dedicated I3C pins to the block. Also the open-drain enable pin for I3C must be configured in open-drain with internal pull up enabled (this pin configuration implies usage of external pull-up resistors)</p>
<h2><a class="anchor" id="group_i3c_clock"></a>
Assign Clock Divider</h2>
<p>A clock source must be connected to the block to oversample input and output signals, in this document this clock will be referred as clk_i3c. You must use one of the 8-bit or 16-bit dividers. Use the <a class="el" href="group__group__sysclk.html">SysClk (System Clock)</a> driver API to do this.</p>
<h2><a class="anchor" id="group_i3c_data_rate"></a>
Configure Data Rate</h2>
<p>To get I3C target operation with the desired data rate, the clk_i3c must be fast enough to provide sufficient oversampling. Use the <a class="el" href="group__group__sysclk.html">SysClk (System Clock)</a> driver API to do this.</p>
<p>To get I3C controller operation with the desired data rate, the source clock frequency and SCL low and high phase duration must be configured. Use the <a class="el" href="group__group__sysclk.html">SysClk (System Clock)</a> driver API to configure source clock frequency. Then call <a class="el" href="group__group__i3c__controller__functions.html#ga4dc10dc760e96cdeb83efb041df91522">Cy_I3C_SetDataRate</a> to set the SCL low, high phase duration This function sets SCL low and high phase settings based on source clock frequency.</p>
<h2><a class="anchor" id="group_i3c_intr"></a>
Configure Interrupt</h2>
<p>The interrupt is mandatory for I3C operation. The driver provides three interrupt functions: <a class="el" href="group__group__i3c__general__functions.html#ga49ae336a4700e33a34f1a17e34fe7149">Cy_I3C_Interrupt</a>, <a class="el" href="group__group__i3c__interrupt__functions.html#ga1d1ec9b401cbcab94abec3d2c7721a80">Cy_I3C_TargetInterrupt</a>, and <a class="el" href="group__group__i3c__interrupt__functions.html#ga7b29e00b5e0a774d4ab50d6674336663">Cy_I3C_ControllerInterrupt</a>. One of these functions must be called in the interrupt handler for the selected instance. Call <a class="el" href="group__group__i3c__interrupt__functions.html#ga1d1ec9b401cbcab94abec3d2c7721a80">Cy_I3C_TargetInterrupt</a> when I3C is configured to operate as a target, <a class="el" href="group__group__i3c__interrupt__functions.html#ga7b29e00b5e0a774d4ab50d6674336663">Cy_I3C_ControllerInterrupt</a> when I3C is configured to operate as a controller and <a class="el" href="group__group__i3c__general__functions.html#ga49ae336a4700e33a34f1a17e34fe7149">Cy_I3C_Interrupt</a> when I3C is configured to operate as controller and target. Using the target- or controller-specific interrupt function allows reducing the flash consumed by the I3C driver. Also this interrupt must be enabled in the NVIC otherwise it will not work. </p><dl class="section note"><dt>Note</dt><dd>The I3C driver documentation refers to the <a class="el" href="group__group__i3c__general__functions.html#ga49ae336a4700e33a34f1a17e34fe7149">Cy_I3C_Interrupt</a> function when interrupt processing is mandatory for the operation. This is done to simplify the readability of the driver's documentation. The application should call the target- or controller-specific interrupt functions <a class="el" href="group__group__i3c__interrupt__functions.html#ga1d1ec9b401cbcab94abec3d2c7721a80">Cy_I3C_TargetInterrupt</a> or <a class="el" href="group__group__i3c__interrupt__functions.html#ga7b29e00b5e0a774d4ab50d6674336663">Cy_I3C_ControllerInterrupt</a>, when appropriate.</dd></dl>
<h2><a class="anchor" id="group_i3c_enable"></a>
Enable I3C</h2>
<p>Finally, enable the I3C operation by calling <a class="el" href="group__group__i3c__general__functions.html#gaa4c085f9536297a7b732c0de64dddf3c">Cy_I3C_Enable</a>. Then I3C target starts respond to the assigned address and I3C controller ready to execute transfers.</p>
<h1><a class="anchor" id="group_i3c_use_cases"></a>
Common Use Cases</h1>
<h2><a class="anchor" id="group_i3c_controller_mode"></a>
Controller Operation</h2>
<p>Call <a class="el" href="group__group__i3c__controller__functions.html#ga809dbe735385bd2c44a0c2c0a33e78d4">Cy_I3C_ControllerRead</a> or <a class="el" href="group__group__i3c__controller__functions.html#ga4a34d0624c7d64887670e697477ae26a">Cy_I3C_ControllerWrite</a> to communicate with the target. These functions do not block and only start a transaction. After a transaction starts, the <a class="el" href="group__group__i3c__general__functions.html#ga49ae336a4700e33a34f1a17e34fe7149">Cy_I3C_Interrupt</a> handles further data transaction until its completion (successfully or with error occurring). To monitor the transaction, use <a class="el" href="group__group__i3c__controller__functions.html#ga56b7bb04e2006a137f665e0a82624aae">Cy_I3C_GetBusStatus</a> or register callback function using <a class="el" href="group__group__i3c__general__functions.html#ga9d473875a145097f54beef04d22af073">Cy_I3C_RegisterEventCallback</a> to be notified about <a class="el" href="group__group__i3c__macros__callback__events.html">I3C Callback Events</a>.</p>
<h2><a class="anchor" id="group_i3c_target"></a>
Target Operation</h2>
<p>Target operation requires the <a class="el" href="group__group__i3c__general__functions.html#ga49ae336a4700e33a34f1a17e34fe7149">Cy_I3C_Interrupt</a> be called inside the interrupt handler. The read and write buffers must be provided for the target to enable communication with the controller. Use <a class="el" href="group__group__i3c__target__functions.html#ga781eaf02de8da98ff85a2344e45dfdc6">Cy_I3C_TargetConfigReadBuf</a> and <a class="el" href="group__group__i3c__target__functions.html#ga69be0f9ba226fcbdbf7d5aeca0eb8a20">Cy_I3C_TargetConfigWriteBuf</a> for this purpose. Note that after transaction completion the buffer must be configured again. Otherwise, the same buffer is used starting from the point where the controller stopped a previous transaction. For example: The read buffer is configured to be 10 bytes and the controller reads 8 bytes. If the read buffer is not configured again, the next controller read will start from the 9th byte. To monitor the transaction status, use <a class="el" href="group__group__i3c__controller__functions.html#ga56b7bb04e2006a137f665e0a82624aae">Cy_I3C_GetBusStatus</a> or use <a class="el" href="group__group__i3c__general__functions.html#ga9d473875a145097f54beef04d22af073">Cy_I3C_RegisterEventCallback</a> to register a callback function to be notified about <a class="el" href="group__group__i3c__macros__callback__events.html">I3C Callback Events</a>.</p>
<dl class="section note"><dt>Note</dt><dd>I3C supports only Primary Controller mode. Secondary controller mode and Target mode are not supported in the current release.</dd></dl>
<h1><a class="anchor" id="group_i3c_lp"></a>
Low Power Support</h1>
<p>The I3C driver provides callback functions to handle power mode transition. The callback <a class="el" href="group__group__i3c__low__power__functions.html#gaebff47196088e43c57c1c91d14022ee9">Cy_I3C_DeepSleepCallback</a> must be called during execution of <a class="el" href="group__group__syspm__functions__power.html#ga5150c28fe4d2626720c1fbf74b3111ca">Cy_SysPm_CpuEnterDeepSleep</a> <a class="el" href="group__group__i3c__low__power__functions.html#ga870843513e47af0796e149d6da617b73">Cy_I3C_HibernateCallback</a> must be called during execution of <a class="el" href="group__group__syspm__functions__power.html#gae97647a28c370674ba57d451d21d1c51">Cy_SysPm_SystemEnterHibernate</a>. To trigger the callback execution, the callback must be registered before calling the power mode transition function. Refer to <a class="el" href="group__group__syspm.html">SysPm (System Power Management)</a> driver for more information about power mode transitions and callback registration.</p>
<h1><a class="anchor" id="group_i3c_changelog"></a>
Changelog</h1>
<table class="doxtable">
<tr>
<th>Version</th><th>Changes</th><th>Reason for Change </th></tr>
<tr>
<td>1.0 </td><td>Initial version </td><td></td></tr>
</table>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__i3c__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i3c__macros.html">Macros</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__i3c__enums"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i3c__enums.html">Enumerated Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__i3c__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i3c__data__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__i3c__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__i3c__functions.html">Functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>MTB CAT1 Peripheral driver library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
